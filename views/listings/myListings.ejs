<% layout('/layouts/boilerplate') %>
  <div class="container mt-5">
    <h2 class="mb-3">My Listings</h2>

    <% if (myListings.length===0) { %>
      <p>You havenâ€™t created any listings yet.</p>
      <% } else { %>
        <div class="row g-4">
          <% myListings.forEach(listing=> { %>
            <div class="col-lg-4 col-md-6 col-sm-12">
              <div class="card shadow-sm border-0 rounded-4 overflow-hidden h-100">

                <!-- Image with Badge & Hover Eye -->
                <div class="position-relative listing-card">
                  <a href="/listings/<%= listing._id %>">
                    <img
                      src="<%= (listing.images && listing.images.length > 0) ? listing.images[0].url : '/images/default-placeholder.png' %>"
                      class="card-img-top" alt="<%= listing.title %>" style="height: 18rem; object-fit: cover;">
                  </a>

                  <!-- Badge -->
                  <span class="badge bg-dark position-absolute top-0 start-0 m-2 px-3 py-1 rounded-pill">
                    <%= listing.Type || "NXTDoor" %>
                  </span>

                  <!-- Hover Eye Overlay -->
                  <a href="/listings/<%= listing._id %>" class="eye-overlay">
                    <i class="fa fa-eye"></i>
                  </a>
                </div>

                <!-- Card Body -->
                <div class="card-body mt-3">
                  <h5 class="card-title fw-bold mb-2">
                    <%= listing.title %>
                  </h5>
                  <p class="text-muted small mb-2">
                    <i class="fa fa-calendar"></i>
                    <%= new Date(listing.createdAt).toLocaleDateString("en-US", { year: "numeric" , month: "short" ,
                      day: "numeric" }) %>
                  </p>
                  <% if (listing.price) { %>
                    <p class="text-secondary mb-1">&#8377; <%= listing.price.toLocaleString("en-IN") %>
                    </p>
                    <% } %>
                      <p class="card-text text-secondary">
                        <%= listing.description ? (listing.description.length> 80
                          ? listing.description.substring(0, 80) + "..."
                          : listing.description)
                          : "No description available" %>
                      </p>
                </div>

                <!-- Card Footer -->
                <div class="card-footer bg-white border-0 d-flex justify-content-between">
                  <a href="#" class="text-danger"><i class="fa fa-heart"></i></a>
                  <a href="/listings/<%= listing._id %>" class="text-secondary"><i class="fa fa-eye"></i></a>
                </div>
              </div>
            </div>
            <% }) %>
        </div>
        <% } %>
  </div>